---
title: "fireã¨poetryã§ä½œã‚‹cliã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³"
emoji: "ğŸ”¥"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["python","cli"]
published: true
---

[google/python-fire: Python Fire is a library for automatically generating command line interfaces (CLIs) from absolutely any Python object.](https://github.com/google/python-fire)

cliã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¯[Click](https://click.palletsprojects.com/en/8.0.x/)ç­‰è‰²ã€…ã‚ã‚‹ã‘ã©ã€fire(googleè£½)ã¯ã‚·ãƒ³ãƒ—ãƒ«ã§ã‚ã‹ã‚Šã‚„ã™ã„ã€‚

ã“ã“ã§ã¯[Poetry](https://python-poetry.org/docs/)ã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ã†æ–¹æ³•ã‚’è¨˜éŒ²ã—ã¦è¡Œãã¾ã™ã€‚

â€»ã“ã®è¨˜äº‹ã§ã¯poetryã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•ç­‰ã¯çœç•¥ã—ã¾ã™ã€‚

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ

ä¾‹ã¨ã—ã¦`myapp`ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ã‚’ä½œæˆã—ã¾ã™ã€‚myappã®éƒ¨åˆ†ã¯å¥½ãã«å‘½åã—ã¦ãã ã•ã„ã€‚

```bash
poetry new myapp
cd myapp
poetry add fire
```

myappãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«cli.pyã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚poetryã®è¨­å®šã«ã‚ˆã‚Šsrcãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒç„¡ã„å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚

```bash
â”œâ”€â”€ src
â”‚   â””â”€â”€ myapp
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ cli.py
â””â”€â”€ tests
    â””â”€â”€ __init__.py
```
## ã‚³ãƒãƒ³ãƒ‰ã®ä½œæˆ

å…¬å¼ã®ã‚µãƒ³ãƒ—ãƒ«ãã®ã¾ã¾ã§ã™ãŒã€helloé–¢æ•°ã‚’ä½œæˆã—ã€`fire.Fire(hello)`ã¨ã™ã‚‹ã ã‘ã§ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰å®Ÿè¡Œã§ãã¾ã™ã€‚

```python
import fire

def hello(name="World"):
    return "Hello %s!" % name


if __name__ == "__main__":
    fire.Fire(hello)
```
`poetry shell`ã§ä»®æƒ³ç’°å¢ƒã«å…¥ã‚Šã€cli.pyã‚’å®Ÿè¡Œã™ã‚‹ã¨ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã‚’å—ã‘å–ã£ã¦é–¢æ•°ãŒèµ°ã‚Šã¾ã™ã€‚

```bash
# å¼•æ•°ä½ç½®ã§æŒ‡å®š
> python src/myapp/cli.py Japan
# å¼•æ•°åã§æŒ‡å®š
> python src/myapp/cli.py --name Japan
# çœç•¥å½¢ã§æŒ‡å®š
> python src/myapp/cli.py -n Japan
```

`myapp`ã ã‘ã§èµ·å‹•ã§ãã‚‹ã‚ˆã†ã«`if __name__ == "__main__":`ã‚’`def main():`ã«æ›¸ãæ›ãˆã¾ã™ã€‚

```python
import fire

def hello(name="World"):
    return "Hello %s!" % name


def main():
    fire.Fire(hello)
```

`pyproject.toml`ã«`myapp`ã‚’è¿½è¨˜ã—ã¾ã™ã€‚

```bash
[tool.poetry.scripts]
myapp = "myapp.cli:main"
```

ã“ã‚Œã§`poetry install`ã™ã‚Œã°`myapp`ã ã‘ã§èµ·å‹•ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```bash
> myapp Japan
Hello Japan!
```

## ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰åŒ–

ä¾‹ãˆã°gitã‚³ãƒãƒ³ãƒ‰ã«ã¯ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ãŒã‚ã‚Šã¾ã™ã€‚`git status`ã‚„`git commit`ã®ã‚ˆã†ã«ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã‚’è¨­å®šã™ã‚‹ã¨å‘¼ã³å‡ºã›ã‚‹é–¢æ•°ã¯ç„¡é™å¤§ã«åºƒãŒã‚Šã¾ã™ã€‚

cli.pyã‚’æ›¸ãæ›ãˆã¾ã™ã€‚

```python
import fire

def hello(name="World"):
    return "Hello %s!" % name


def add(int1, int2):
    return int1 + int2


def main():
    fire.Fire({"hello": hello, "add": add})
```

`add`é–¢æ•°ã‚’è¿½åŠ ã—ã¦`fire.Fire({"hello": hello, "add": add})`ã¨dictã«å¤‰æ›´ã—ã¾ã—ãŸã€‚

ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã¨ã—ã¦å‘¼ã‚“ã§ã¿ã¾ã™ã€‚

```bash
> myapp hello Japan
Hello Japan!

> myapp add 1 2
3
```

## ã‚°ãƒ­ãƒ¼ãƒãƒ«åŒ–

ã“ã®çŠ¶æ…‹ã§ã¯ã‚ãã¾ã§ä»®æƒ³ç’°å¢ƒã®ã‚³ãƒãƒ³ãƒ‰ãªã®ã§ä»–ã®å ´æ‰€ã‹ã‚‰å‘¼ã³å‡ºã›ã¾ã›ã‚“ã€‚ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãŸã‚ä»¥ä¸‹ã®æ‰‹é †ã‚’è¡Œã„ã¾ã™ã€‚

```bash
> poetry build
Building myapp (0.1.0)
  - Building sdist
  - Built myapp-0.1.0.tar.gz
  - Building wheel
  - Built myapp-0.1.0-py3-none-any.whl
```

ã“ã‚Œã§`dist`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒ“ãƒ«ãƒ‰ã§ãã¾ã—ãŸã®ã§ã€ã“ã‚Œã‚’ä½¿ã£ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚ä»Šå›ã¯`myapp-0.1.0.tar.gz`ã‚’ä½¿ã£ã¦ã¿ã¾ã™ã®ã§ãƒ•ãƒ«ãƒ‘ã‚¹ã‚’æ§ãˆã¦ãŠã„ã¦ãã ã•ã„ã€‚

```bash
cd
pip install /path/to/myapp/dist/myapp-0.1.0.tar.gz
```

`pip install`ã®éƒ¨åˆ†ã¯ç’°å¢ƒã«å¿œã˜ã¦`pip3 install`ç­‰ã«å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚

ã“ã‚Œã§ã©ã“ã‹ã‚‰ã§ã‚‚`myapp`ã‚³ãƒãƒ³ãƒ‰ãŒå‘¼ã³å‡ºã›ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

ä¸è¦ã«ãªã£ãŸã‚‰`pip uninstall myapp`ã§å‰Šé™¤ã§ãã¾ã™ã€‚


å…¬å¼ã§ã¯classã‚’ä½¿ã£ãŸæ–¹æ³•ç­‰ã‚‚æ›¸ã„ã¦ã‚ã‚‹ã®ã§ã”å‚è€ƒã«ã€‚

[python-fire/guide.md at master Â· google/python-fire](https://github.com/google/python-fire/blob/master/docs/guide.md)
